<!DOCTYPE html>
<html>
<head>
	<meta name="description" content="University final year project on single-cell RNA sequencing">
  <meta name="keywords" content="scRNA-seq, clustering, topological data analysis">
  <meta name="author" content="TomMakesThings">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Links to the CSS stylesheets -->
	<link rel="stylesheet" href="Stylesheets\main.css">
	<link rel="stylesheet" href="Stylesheets\navbar.css">
	<link rel="stylesheet" href="Stylesheets\about.css">
	<link rel="stylesheet" href="Stylesheets\dataset.css">
	<link rel="stylesheet" href="Stylesheets\code.css">
	<link rel="stylesheet" href="Stylesheets\graphs.css">
	<link rel="stylesheet" href="Stylesheets\topicmodelling.css">
	<link rel="stylesheet" href="Stylesheets\footer.css">
</head>

<body>

<div class="header">
	<div id="header-top" onmouseover="profileHover(this);" onmouseout="profileUnhover(this);">
		<div id="header-tom">
			<a href="https://tommakesthings.github.io/" target="_blank"><img src="Assets/Images/Profile.png" alt="GitHub profile picture" class="profilepic" id="tomprofile" onmouseover="profileHover(this);" onmouseout="profileUnhover(this);"></a>
			<a href="https://tommakesthings.github.io/" target="_blank" id="username" class="navtext">TomMakesThings +</a>
			<a href="https://tommakesthings.github.io/" target="_blank"><p id="hint">(click to see more of my work)</p></a>
		</div>
		<div id="header-others">
			<a href="https://github.com/rogerchenrc" target="_blank"><img src="https://avatars.githubusercontent.com/u/56882421?v=4" alt="GitHub profile picture" class="profilepic other-profile"></a>
			<a href="https://github.com/laviniafr" target="_blank"><img src="https://avatars.githubusercontent.com/u/66881011?v=4" alt="GitHub profile picture" class="profilepic other-profile"></a>
		</div>
	</div>
	<div id="header-center">
		<a href="https://github.com/TomMakesThings/Movie-Genre-Predictor" target="_blank" id="sitename" class="navtext">IMDb Movie Genre Predictor</a>
		<a href="https://github.com/TomMakesThings/Movie-Genre-Predictor" target="_blank"><img src="Assets/Images/Clapper.png" alt="Film clapper" id="clapper"></a>
	</div>
	<div class="header-right" id="visible-header">
		<a href="#about" class="navtext">About</a>
		<a href="#data" class="navtext">Data</a>
		<a href="#classifier" class="navtext">Classifier</a>
		<a href="#topicmodelling" class="navtext">Topic Modelling</a>
		<a href="#code" class="navtext">Running the Code</a>
		<a href="#contributions" class="navtext">Contributions</a>
	</div>
</div>

<div class="content">
	<div>
		<a name="about" class="anchor"></a>
  	<h1>About</h1>
		<p>This site explains a natural language processing (NLP) group project done in collaboration with <a href="https://github.com/rogerchenrc" target="_blank">rogerchenrc</a> and <a href="https://github.com/laviniafr" target="_blank">laviniafr</a>.
			In this we tested different NLP techniques and model architectures to create a CI/CD pipeline to train and deploy a multi-label classifier.
			The classifier was trained on dataset of movie descriptions to predict the top fitting genre(s) with 12 possible values including: Drama, Comedy, Action, Crime, Thriller, Romance, Horror, Adventure, Mystery, Family, Fantasy and Sci-Fi.
		 	The state of the best trained model was then saved to file and deployed on a custom built web server as demonstrated in the video below:
		</p>

		<br>

		<video controls>
		  <source src="Assets/Videos/Site-Demo.mov" type="video/mp4">
				Your browser does not support the video tag.
		</video>

	</div>

	<br>

	<div>
		<a name="data" class="anchor"></a>
		<h1>Data</h1>
		<h2>The Dataset</h2>
		<p>We decided to use the <a href="https://www.kaggle.com/stefanoleone992/imdb-extensive-dataset">IMDb movies extensive dataset</a> from Kaggle.
			This contains 84,983 samples providing a sufficient number to train a robust classifier.
			Although each film has many attributes, such as year of release and director, we only required the original title, description and list of genres to use as training labels.
			Some pre-processing was therefore required to remove samples missing this information and to remove unnecessary attributes. This lead to 2,115 samples being dropped with 83,740 remaining.
		</p>
		<p><img class="dataset centered" src="Assets/Images/Dataset.png"></p>

		<br>

		<h2>Analysing the Labels</h2>
		<p>All films have between one and three genres, each of which can be used as a label during classification.
			After extracting the genres from each sample, it was discovered that there were 25 unique values.
			However, they were not evenly distributed with 26.7% of samples belonging to Drama and eight genres with less than 1%.
		</p>
		<div>
			<div class="pie" style="float: none; width: 100%; margin-bottom: -40px; margin-top: -70px;">
				<iframe src="Assets/Graphs/Label_Distribution_Raw.html" class="graph-html"></iframe>
			</div>
			<p><img src="Assets/Images/Movies-Per-Genre.png" style="max-width: 900px; width: 100%; display: none;"></p>
			<p><img src="Assets/Images/Genres-Per-Movie.png" style="max-width: 450px; width: 100%; display: none;"></p>
		</div>
		<div class="video-buttons-small-screen">
			<button class="circle-button small-screen-button next-button" onclick="aboutVideoChanger(this)"><p>ðŸ¡°</p></button>
			<button class="circle-button small-screen-button previous-button" onclick="aboutVideoChanger(this)"><p>ðŸ¡²</p></button>
		</div>
		<p>As not all genres have enough representative samples, we decided to only keep the top seven.
			As this can cause problems when training a neural network, it was necessary</p>
		<div class="pies">
			<div class="pie">
				<iframe src="Assets/Graphs/Label_Distribution_Unbalanced.html" class="graph-html"></iframe>
			</div>
			<div class="pie">
				<iframe src="Assets/Graphs/Label_Distribution_Processed.html" class="graph-html"></iframe>
			</div>
		</div>

		<br style="clear: both;">
		<br>

		<p>rherh</p>

		<br>

		<p>As each film has between one and three genres, we decided to perform multi-label classification.
			This is when the classifer is able to make multiple predictions rather than just one for each sample.
		</p>

		<br>

		<h2>Analysing the Movie Descriptions</h2>
		<h3>ScatterText</h3>
		<div class="graph scattertext">
			<iframe src="Assets/Graphs/Scattertext_Horror.html" class="graph-html"></iframe>
		</div>
		<div class="graph scattertext">
			<iframe src="Assets/Graphs/Scattertext_Romance.html" class="graph-html"></iframe>
		</div>

	</div>

	<br>

	<div>
		<a name="classifier" class="anchor"></a>
		<h1>Classifier</h1>
		<h2>Testing and Development</h2>
		<p>When given a sample, the model outputs one to three genres with a percentage corresponding to its relevance for each one.</p>

		<h2>Pipeline</h2>
		<h2>Code<h2>
		<div class="notebook">
			<iframe src="Notebooks/LSTM-IMDb-Film-Genre-Predictor.html" class="notebook-html"></iframe>
		</div>

	</div>

	<br>

	<div>
		<a name="topicmodelling" class="anchor"></a>
		<h1>Topic Modelling</h1>
		<a name="genes" class="anchor"></a>
		<h2>Latent Dirichlet Allocation (LDiA)</h2>
		<p>In </p>

		<div class="graph">
			<iframe src="Assets/Graphs/Gensim_LDiA_7_Topics.html" class="graph-html"></iframe>
		</div>

		<p>In </p>

		<div class="graph">
			<iframe src="Assets/Graphs/tSNE_LDiA_7_Topics.html" class="graph-html"></iframe>
		</div>

		<p><img src="Assets/Images/LDiA_Coherence.png" class="coherence-graph centered"></p>

		<div class="graph">
			<iframe src="Assets/Graphs/tSNE_LDiA_47_Topics.html" class="graph-html"></iframe>
		</div>

		<a name="scrnaseq" class="anchor"></a>
		<h2>Latent Semantic Analysis</h2>
		<p>Si</p>

		<div class="graph">
			<iframe src="Assets/Graphs/tSNE_LSA_7_Topics.html" class="graph-html"></iframe>
		</div>

		<p><img src="Assets/Images/LSA_Coherence.png" class="coherence-graph centered"></p>

		<div class="graph">
			<iframe src="Assets/Graphs/tSNE_LSA_2_Topics.html" class="graph-html"></iframe>
		</div>

		<h2>Topic Modelling Code<h2>
		<div class="notebook">
			<iframe src="Notebooks/LDiA-and-LSA-Topic-Modelling.html" class="notebook-html"></iframe>
		</div>

	</div>

	<br>

	<div>
		<a name="code" class="anchor"></a>
		<h1>Running the Code</h1>
		<p>The full code has been uploaded to <a href="https://github.com/TomMakesThings/Movie-Genre-Predictor" target="_blank">GitHub</a>.
			To download the repository, <a href="https://github.com/TomMakesThings/Movie-Genre-Predictor/archive/refs/heads/main.zip">click here.</a>
		</p>
		<p>To ensure all team members could execute the code during development, it was created using a <a href="https://www.anaconda.com/products/individual" target="_blank">conda environment</a>.
			This environment has been saved as a YAML file, environment.yml, and is included in the repository.
			To recreate this environment, open the Anaconda prompt and enter the command below, where environment.yml is the file path of the enviroment file.
		</p>
		<p><a class="code">conda env create -f environment.yml</a></p>

		<br>

		<h2>Web application</h2>
		<p>To run the classifier web application:</p>
		<ol>
			<li><a class="code">conda activate MoviePredictor</a></li>
			<li>Navigate to <a class="code">Web_App/flaskr</a></li>
			<li>Run command <a class="code">python main.py</a></li>
		</ol>

		<br>

		<video controls>
			<source src="Assets/Videos/Site-Launch.mov" type="video/mp4">
				Your browser does not support the video tag.
		</video>

		<br>

		<h2>Jupyter notebooks</h2>

	</div>

	<br>

	<div>
		<a name="contributions" class="anchor"></a>
		<h1>Contributions</h1>
		<h2>Tom</h2>
		<ul>
			<li>CI/CD pipeline development</li>
			<li>Model training, testing and optimization</li>
			<li>Hosting the selected model on the backend of the web application</li>
			<li>Creation of this site</li>
		</ul>
		<h2>Roger</h2>
		<ul>
			<li>Backend development of the Flask web application</li>
			<li>Hosting the app prototype on Heroku</li>
			<li>Functional testing of the application</li>
		</ul>
		<h2>Lavinia</h2>
		<ul>
			<li>Research of web service hosting options</li>
			<li>Frontend development of the web application</li>
			<li>Creation of video demonstrations</li>
		</ul>
	</div>

	<br>

</div>

<br>

<div class="footer">
	<div class="footer-center">
		<a href="https://github.com/TomMakesThings"><b>&copy; TomMakesThings <script>document.write(new Date().getUTCFullYear());</script></b></a>
	</div>
</div>

<script src="Javascript/graph_search.js"></script>
<script src="Javascript/navbar.js"></script>

</body>
</html>
